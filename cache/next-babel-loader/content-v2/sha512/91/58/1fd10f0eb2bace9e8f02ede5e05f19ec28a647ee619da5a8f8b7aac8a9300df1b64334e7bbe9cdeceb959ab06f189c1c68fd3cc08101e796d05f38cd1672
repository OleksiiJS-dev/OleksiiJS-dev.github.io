{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\archivegit\\\\blind-blind\\\\pages\\\\collections\\\\[collection].tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useRouter } from 'next/router';\nimport Error from '../_error';\nimport GoodsList from '../../src/components/Goods/GoodsList';\nimport GoodsListTitle from '../../src/components/Goods/GoodsListTitle';\nimport Seo from '../../src/components/Seo/Seo';\nimport SubCollections from '../../src/components/SubCollections/SubCollections';\nimport { getCockpitCollection } from '../../src/utils/getCockpitData';\nimport { SEO_ITEMS, DEFAULT_DESCRIPTION } from '../../src/constants/seoItems';\nimport { LANGUAGES } from '../../src/constants/languages';\n\nconst CollectionPage = ({\n  collection,\n  categories,\n  goods,\n  subCollections\n}) => {\n  const {\n    locale,\n    defaultLocale\n  } = useRouter();\n  if (!collection) return /*#__PURE__*/_jsxDEV(Error, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 30,\n    columnNumber: 27\n  }, this);\n  const collectionDescription = locale === defaultLocale ? collection.description : collection.description_en;\n  const collectionLink = LANGUAGES[locale].path + '/collections' + collection.link;\n  const collectionName = locale === defaultLocale ? collection.title : collection.title_en;\n  if (subCollections) return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Seo, {\n      title: collectionName,\n      description: collectionDescription || DEFAULT_DESCRIPTION[locale],\n      breadcrumbs: [{\n        title: SEO_ITEMS[locale].indexPage.breadcrumbName,\n        link: SEO_ITEMS[locale].indexPage.link\n      }, {\n        title: collectionName,\n        link: collectionLink\n      }],\n      lang: locale,\n      path: process.env.NEXT_PUBLIC_SITE_URL + collectionLink\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(GoodsListTitle, {\n      title: collectionName\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(SubCollections, {\n      subCollections: subCollections\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"collection-page\",\n    children: [/*#__PURE__*/_jsxDEV(Seo, {\n      title: collectionName,\n      description: collectionDescription || DEFAULT_DESCRIPTION[locale],\n      breadcrumbs: [{\n        title: SEO_ITEMS[locale].indexPage.breadcrumbName,\n        link: SEO_ITEMS[locale].indexPage.link\n      }, {\n        title: collectionName,\n        link: collectionLink\n      }],\n      lang: locale,\n      path: process.env.NEXT_PUBLIC_SITE_URL + collectionLink\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(GoodsListTitle, {\n      title: collectionName\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"goods-container\",\n      children: /*#__PURE__*/_jsxDEV(GoodsList, {\n        goods: goods,\n        categories: categories\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n\nexport const getServerSideProps = async ({\n  query: {\n    collection\n  },\n  locale,\n  defaultLocale\n}) => {\n  const collections = await getCockpitCollection('Collections', 'filter[link]=/' + collection);\n  const curCollection = collections.total ? collections.entries[0] : null;\n  const subCollections = curCollection ? await getCockpitCollection('SubCollections', 'filter[collection._id]=' + curCollection._id) : null;\n  const cockpitGoodsData = await getCockpitCollection('Goods', `filter[collection._id]=${curCollection._id}&sort[order]=-1`);\n  const cockpitCategoriesData = await getCockpitCollection('Categories');\n  const goods = cockpitGoodsData.entries.map(good => _objectSpread(_objectSpread({}, good), {}, {\n    title: locale === defaultLocale ? good.title : good.title_en\n  })).filter(({\n    isVisible\n  }) => isVisible !== false); // .sort((a, b) => (a.order > b.order ? 1 : -1));\n\n  const categories = cockpitCategoriesData.entries.map(category => _objectSpread(_objectSpread({}, category), {}, {\n    title: locale === defaultLocale ? category.title : category.title_en\n  }));\n  const curSubCollections = subCollections !== null && subCollections !== void 0 && subCollections.total ? subCollections.entries : null;\n  return {\n    props: {\n      collection: curCollection,\n      subCollections: curSubCollections,\n      categories,\n      goods: {\n        entries: goods\n      }\n    }\n  };\n};\nexport default CollectionPage;","map":{"version":3,"sources":["D:/archivegit/blind-blind/pages/collections/[collection].tsx"],"names":["useRouter","Error","GoodsList","GoodsListTitle","Seo","SubCollections","getCockpitCollection","SEO_ITEMS","DEFAULT_DESCRIPTION","LANGUAGES","CollectionPage","collection","categories","goods","subCollections","locale","defaultLocale","collectionDescription","description","description_en","collectionLink","path","link","collectionName","title","title_en","indexPage","breadcrumbName","process","env","NEXT_PUBLIC_SITE_URL","getServerSideProps","query","collections","curCollection","total","entries","_id","cockpitGoodsData","cockpitCategoriesData","map","good","filter","isVisible","category","curSubCollections","props"],"mappings":"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","sourcesContent":["import { NextPage, GetServerSideProps } from 'next';\r\nimport { useRouter } from 'next/router';\r\n\r\nimport Error from '../_error';\r\n\r\nimport GoodsList from '../../src/components/Goods/GoodsList';\r\nimport GoodsListTitle from '../../src/components/Goods/GoodsListTitle';\r\nimport Seo from '../../src/components/Seo/Seo';\r\nimport SubCollections from '../../src/components/SubCollections/SubCollections';\r\n\r\nimport { ICollectionPageProps } from '../../src/pagesTypes';\r\nimport {\r\n  ICockpitCategoriesEntries,\r\n  ICockpitGoodsEntries,\r\n} from '../../src/cockpitTypes';\r\n\r\nimport { getCockpitCollection } from '../../src/utils/getCockpitData';\r\n\r\nimport { SEO_ITEMS, DEFAULT_DESCRIPTION } from '../../src/constants/seoItems';\r\nimport { LANGUAGES } from '../../src/constants/languages';\r\n\r\nconst CollectionPage: NextPage<ICollectionPageProps> = ({\r\n  collection,\r\n  categories,\r\n  goods,\r\n  subCollections,\r\n}) => {\r\n  const { locale, defaultLocale } = useRouter();\r\n\r\n  if (!collection) return <Error />;\r\n\r\n  const collectionDescription =\r\n    locale === defaultLocale\r\n      ? collection.description\r\n      : collection.description_en;\r\n\r\n  const collectionLink =\r\n    LANGUAGES[locale as 'ru' | 'en'].path + '/collections' + collection.link;\r\n  const collectionName =\r\n    locale === defaultLocale ? collection.title : collection.title_en;\r\n\r\n  if (subCollections)\r\n    return (\r\n      <>\r\n        <Seo\r\n          title={collectionName}\r\n          description={\r\n            collectionDescription || DEFAULT_DESCRIPTION[locale as 'ru' | 'en']\r\n          }\r\n          breadcrumbs={[\r\n            {\r\n              title: SEO_ITEMS[locale as 'ru' | 'en'].indexPage.breadcrumbName,\r\n              link: SEO_ITEMS[locale as 'ru' | 'en'].indexPage.link,\r\n            },\r\n            {\r\n              title: collectionName,\r\n              link: collectionLink,\r\n            },\r\n          ]}\r\n          lang={locale as 'ru' | 'en'}\r\n          path={process.env.NEXT_PUBLIC_SITE_URL + collectionLink}\r\n        />\r\n        <GoodsListTitle title={collectionName} />\r\n        <SubCollections subCollections={subCollections} />\r\n      </>\r\n    );\r\n\r\n  return (\r\n    <div className=\"collection-page\">\r\n      <Seo\r\n        title={collectionName}\r\n        description={\r\n          collectionDescription || DEFAULT_DESCRIPTION[locale as 'ru' | 'en']\r\n        }\r\n        breadcrumbs={[\r\n          {\r\n            title: SEO_ITEMS[locale as 'ru' | 'en'].indexPage.breadcrumbName,\r\n            link: SEO_ITEMS[locale as 'ru' | 'en'].indexPage.link,\r\n          },\r\n          {\r\n            title: collectionName,\r\n            link: collectionLink,\r\n          },\r\n        ]}\r\n        lang={locale as 'ru' | 'en'}\r\n        path={process.env.NEXT_PUBLIC_SITE_URL + collectionLink}\r\n      />\r\n      <GoodsListTitle title={collectionName} />\r\n      <div className=\"goods-container\">\r\n        <GoodsList goods={goods} categories={categories} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const getServerSideProps: GetServerSideProps = async ({\r\n  query: { collection },\r\n  locale,\r\n  defaultLocale,\r\n}) => {\r\n  const collections = await getCockpitCollection(\r\n    'Collections',\r\n    'filter[link]=/' + collection\r\n  );\r\n  const curCollection = collections.total ? collections.entries[0] : null;\r\n\r\n  const subCollections = curCollection\r\n    ? await getCockpitCollection(\r\n        'SubCollections',\r\n        'filter[collection._id]=' + curCollection._id\r\n      )\r\n    : null;\r\n\r\n  const cockpitGoodsData: ICockpitGoodsEntries = await getCockpitCollection(\r\n    'Goods',\r\n    `filter[collection._id]=${curCollection._id}&sort[order]=-1`\r\n  );\r\n\r\n  const cockpitCategoriesData: ICockpitCategoriesEntries = await getCockpitCollection(\r\n    'Categories'\r\n  );\r\n\r\n  const goods = cockpitGoodsData.entries\r\n    .map((good) => ({\r\n      ...good,\r\n      title: locale === defaultLocale ? good.title : good.title_en,\r\n    }))\r\n    .filter(({ isVisible }) => isVisible !== false);\r\n  // .sort((a, b) => (a.order > b.order ? 1 : -1));\r\n\r\n  const categories = cockpitCategoriesData.entries.map((category) => ({\r\n    ...category,\r\n    title: locale === defaultLocale ? category.title : category.title_en,\r\n  }));\r\n\r\n  const curSubCollections = subCollections?.total\r\n    ? subCollections.entries\r\n    : null;\r\n\r\n  return {\r\n    props: {\r\n      collection: curCollection,\r\n      subCollections: curSubCollections,\r\n      categories,\r\n      goods: {\r\n        entries: goods,\r\n      },\r\n    },\r\n  };\r\n};\r\n\r\nexport default CollectionPage;\r\n"]},"metadata":{},"sourceType":"module"}