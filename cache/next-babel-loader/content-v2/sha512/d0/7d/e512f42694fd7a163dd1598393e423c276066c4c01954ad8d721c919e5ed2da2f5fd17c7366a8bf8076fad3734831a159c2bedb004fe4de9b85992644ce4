{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/user/Documents/GitHub/blind-blind/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/user/Documents/GitHub/blind-blind/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:/Users/user/Documents/GitHub/blind-blind/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"C:/Users/user/Documents/GitHub/blind-blind/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\user\\\\Documents\\\\GitHub\\\\blind-blind\\\\pages\\\\_app.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useContext, useEffect, useState } from 'react';\nimport App from 'next/app';\nimport NextNprogress from 'nextjs-progressbar';\nimport Header from '../src/components/Header/Header';\nimport Footer from '../src/components/Footer/Footer';\nimport ModalWindowStart from '../src/components/ModalWindowStart/ModalWindowStart';\nimport ArrowUp from '../src/components/ArrowUp/ArrowUp';\nimport { cartContext } from '../src/context/cartContext';\nimport { indexContext } from '../src/context/cockpitContext';\nimport { currencyContext } from '../src/context/currencyContext';\nimport { getCockpitCollection } from '../src/utils/getCockpitData';\nimport { getCurrencyRate } from '../src/utils/getCurrencyRate';\nimport '../styles/main.scss';\nimport '../styles/intlTelInput.css';\n\nvar MyApp = function MyApp(_ref) {\n  _s();\n\n  var Component = _ref.Component,\n      pageProps = _ref.pageProps,\n      _ref$props = _ref.props,\n      collections = _ref$props.collections,\n      runways = _ref$props.runways,\n      hasStocks = _ref$props.hasStocks;\n  var curCartContext = useContext(cartContext);\n\n  var _useState = useState(curCartContext ? curCartContext.cart : []),\n      cartState = _useState[0],\n      setCartState = _useState[1];\n\n  var _useState2 = useState(0),\n      USDRate = _useState2[0],\n      changeUSDRate = _useState2[1];\n\n  var _useState3 = useState('UAH'),\n      currency = _useState3[0],\n      setCurrency = _useState3[1];\n\n  var _useState4 = useState(0),\n      currencyRate = _useState4[0],\n      setCurrencyRate = _useState4[1];\n\n  var addItemToCart = function addItemToCart(item) {\n    if (!('receiverName' in item)) {\n      var existingItem = cartState.filter(function (el) {\n        return el.id === item.id && !('receiverName' in el) && JSON.stringify(el.details) === JSON.stringify(item.details);\n      });\n\n      if (existingItem.length) {\n        var newItem = existingItem[0];\n        cartState.forEach(function (el) {\n          if (el.id === newItem.id && JSON.stringify(el.details) === JSON.stringify(newItem.details)) el.amount += 1;\n        });\n        setCartState(_toConsumableArray(cartState));\n        return;\n      }\n    }\n\n    setCartState([].concat(_toConsumableArray(cartState), [item]));\n  };\n\n  var removeItemFromCart = function removeItemFromCart(item) {\n    if (!('receiverName' in item)) setCartState(_toConsumableArray(cartState.filter(function (el) {\n      return !(el.id === item.id && JSON.stringify(el.details) === JSON.stringify(item.details));\n    })));else setCartState(_toConsumableArray(cartState.filter(function (el) {\n      return el.id !== item.id;\n    })));\n  };\n\n  var clearCart = function clearCart() {\n    return setCartState([]);\n  };\n\n  useEffect(function () {\n    if (true) {\n      var storageCart = localStorage.getItem('cart');\n\n      if (storageCart) {\n        setCartState(JSON.parse(storageCart));\n      }\n\n      var storageCurrency = localStorage.getItem('currency');\n\n      if (storageCurrency) {\n        setCurrency(JSON.parse(storageCurrency));\n      }\n    }\n  }, []);\n  useEffect(function () {\n    if (!USDRate) getCurrencyRate('USD').then(function (res) {\n      return changeUSDRate(+res);\n    });\n  }, []);\n  useEffect(function () {\n    if (true) {\n      localStorage.setItem('cart', JSON.stringify(cartState));\n      localStorage.setItem('currency', JSON.stringify(currency));\n    }\n  }, [cartState, currency]);\n  useEffect(function () {\n    getCurrencyRate(currency.toString()).then(function (res) {\n      if (currency.toString() === 'RUB') {\n        setCurrencyRate(function () {\n          return 1 / 3;\n        });\n      } else {\n        setCurrencyRate(+res);\n      }\n    })[\"catch\"](function (err) {\n      return console.error(err);\n    });\n  }, [currency]);\n  return /*#__PURE__*/_jsxDEV(indexContext.Provider, {\n    value: {\n      collectionsData: collections,\n      runwaysData: runways,\n      hasStocks: hasStocks\n    },\n    children: /*#__PURE__*/_jsxDEV(currencyContext.Provider, {\n      value: {\n        currency: currency,\n        currencyRate: currencyRate,\n        setCurrency: setCurrency,\n        USDRate: USDRate\n      },\n      children: /*#__PURE__*/_jsxDEV(cartContext.Provider, {\n        value: {\n          cart: cartState,\n          addItem: addItemToCart,\n          removeItem: removeItemFromCart,\n          clearCart: clearCart\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"noscript\", {\n          dangerouslySetInnerHTML: {\n            __html: \"<iframe\\n              src=\\\"https://www.googletagmanager.com/ns.html?id=GTM-5XP658M\\\"\\n              height=\\\"0\\\"\\n              width=\\\"0\\\"\\n              style=\\\"display:none;visibility:hidden\\\"\\n            ></iframe>\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(ModalWindowStart, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(NextNprogress, {\n          color: \"#000\",\n          startPosition: 0.3,\n          stopDelayMs: 200,\n          height: 3\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"main\", {\n          children: /*#__PURE__*/_jsxDEV(Component, _objectSpread({}, pageProps), void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(ArrowUp, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(MyApp, \"T/oVy+lVmpjqsb3s0bt69fd8qAE=\");\n\n_c = MyApp;\n\nMyApp.getInitialProps = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(appContext) {\n    var appProps, _appContext$router, locale, defaultLocale, cockpitDataCollections, cockpitGoods, cockpitDataRunways, stockGoods, runways, collections;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return App.getInitialProps(appContext);\n\n          case 2:\n            appProps = _context.sent;\n            _appContext$router = appContext.router, locale = _appContext$router.locale, defaultLocale = _appContext$router.defaultLocale;\n            _context.next = 6;\n            return getCockpitCollection('Collections', 'filter[inMenu]=true&sort[_o]=1');\n\n          case 6:\n            cockpitDataCollections = _context.sent;\n            _context.next = 9;\n            return getCockpitCollection('Goods');\n\n          case 9:\n            cockpitGoods = _context.sent;\n            _context.next = 12;\n            return getCockpitCollection('Runways', 'filter[inMenu]=true');\n\n          case 12:\n            cockpitDataRunways = _context.sent;\n            stockGoods = cockpitGoods.entries.filter(function (_ref3) {\n              var stockPrice = _ref3.stockPrice;\n              return stockPrice;\n            });\n            runways = cockpitDataRunways.entries.map(function (el) {\n              return {\n                title: locale === defaultLocale ? el.title : el.title_en,\n                link: '/blind-style' + el.link,\n                inMenu: el.inMenu\n              };\n            });\n            collections = cockpitDataCollections.entries.map(function (el) {\n              return {\n                title: locale === defaultLocale ? el.title : el.title_en,\n                link: \"/collections\".concat(el.link),\n                inMenu: el.inMenu,\n                _id: el._id\n              };\n            });\n            return _context.abrupt(\"return\", _objectSpread(_objectSpread({}, appProps), {}, {\n              props: {\n                collections: collections,\n                runways: runways,\n                hasStocks: !!stockGoods.length\n              }\n            }));\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nexport default MyApp;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyApp\");","map":{"version":3,"sources":["C:/Users/user/Documents/GitHub/blind-blind/pages/_app.tsx"],"names":["useContext","useEffect","useState","App","NextNprogress","Header","Footer","ModalWindowStart","ArrowUp","cartContext","indexContext","currencyContext","getCockpitCollection","getCurrencyRate","MyApp","Component","pageProps","props","collections","runways","hasStocks","curCartContext","cart","cartState","setCartState","USDRate","changeUSDRate","currency","setCurrency","currencyRate","setCurrencyRate","addItemToCart","item","existingItem","filter","el","id","JSON","stringify","details","length","newItem","forEach","amount","removeItemFromCart","clearCart","storageCart","localStorage","getItem","parse","storageCurrency","then","res","setItem","toString","err","console","error","collectionsData","runwaysData","addItem","removeItem","__html","getInitialProps","appContext","appProps","router","locale","defaultLocale","cockpitDataCollections","cockpitGoods","cockpitDataRunways","stockGoods","entries","stockPrice","map","title","title_en","link","inMenu","_id"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState } from 'react';\r\nimport App, { AppContext } from 'next/app';\r\nimport { AppProps } from 'next/dist/next-server/lib/router/router';\r\nimport { AppInitialProps } from 'next/dist/next-server/lib/utils';\r\nimport NextNprogress from 'nextjs-progressbar';\r\n\r\nimport {\r\n  ICartGoodsItemProps,\r\n  ICartVoucherItemProps,\r\n} from '../src/components/Cart/Types';\r\nimport Header from '../src/components/Header/Header';\r\nimport Footer from '../src/components/Footer/Footer';\r\nimport ModalWindowStart from '../src/components/ModalWindowStart/ModalWindowStart';\r\nimport ArrowUp from '../src/components/ArrowUp/ArrowUp';\r\n\r\nimport { cartContext } from '../src/context/cartContext';\r\nimport { indexContext } from '../src/context/cockpitContext';\r\nimport { currencyContext } from '../src/context/currencyContext';\r\nimport {\r\n  ICockpitCollectionsRaw,\r\n  ICockpitGoodsRaw,\r\n  ICockpitRunwaysAndLookbooksRaw,\r\n} from '../src/cockpitTypes';\r\nimport { IAppProps } from '../src/pagesTypes';\r\n\r\nimport { getCockpitCollection } from '../src/utils/getCockpitData';\r\nimport { getCurrencyRate } from '../src/utils/getCurrencyRate';\r\n\r\nimport '../styles/main.scss';\r\nimport { ECurrency } from '../src/context/Types';\r\n\r\nimport '../styles/intlTelInput.css';\r\n\r\nconst MyApp = ({\r\n  Component,\r\n  pageProps,\r\n  props: { collections, runways, hasStocks },\r\n}: AppProps & IAppProps): JSX.Element => {\r\n  const curCartContext = useContext(cartContext);\r\n\r\n  const [cartState, setCartState] = useState(\r\n    curCartContext ? curCartContext.cart : []\r\n  );\r\n\r\n  const [USDRate, changeUSDRate] = useState<number>(0);\r\n\r\n  const [currency, setCurrency] = useState<ECurrency>(\r\n    ('UAH' as unknown) as ECurrency\r\n  );\r\n  const [currencyRate, setCurrencyRate] = useState(0);\r\n\r\n  const addItemToCart = (item: ICartGoodsItemProps | ICartVoucherItemProps) => {\r\n    if (!('receiverName' in item)) {\r\n      const existingItem = cartState.filter(\r\n        (el) =>\r\n          el.id === item.id &&\r\n          !('receiverName' in el) &&\r\n          JSON.stringify(el.details) === JSON.stringify(item.details)\r\n      );\r\n\r\n      if (existingItem.length) {\r\n        const newItem = existingItem[0] as ICartGoodsItemProps;\r\n        cartState.forEach((el) => {\r\n          if (\r\n            el.id === newItem.id &&\r\n            JSON.stringify((el as ICartGoodsItemProps).details) ===\r\n              JSON.stringify(newItem.details)\r\n          )\r\n            el.amount += 1;\r\n        });\r\n        setCartState([...cartState]);\r\n        return;\r\n      }\r\n    }\r\n    setCartState([...cartState, item]);\r\n  };\r\n\r\n  const removeItemFromCart = (\r\n    item: ICartGoodsItemProps | ICartVoucherItemProps\r\n  ) => {\r\n    if (!('receiverName' in item))\r\n      setCartState([\r\n        ...cartState.filter(\r\n          (el) =>\r\n            !(\r\n              el.id === item.id &&\r\n              JSON.stringify((el as ICartGoodsItemProps).details) ===\r\n                JSON.stringify(item.details)\r\n            )\r\n        ),\r\n      ]);\r\n    else setCartState([...cartState.filter((el) => el.id !== item.id)]);\r\n  };\r\n\r\n  const clearCart = () => setCartState([]);\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const storageCart = localStorage.getItem('cart');\r\n      if (storageCart) {\r\n        setCartState(JSON.parse(storageCart));\r\n      }\r\n      const storageCurrency = localStorage.getItem('currency');\r\n      if (storageCurrency) {\r\n        setCurrency(JSON.parse(storageCurrency as keyof ECurrency));\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!USDRate) getCurrencyRate('USD').then((res) => changeUSDRate(+res));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.setItem('cart', JSON.stringify(cartState));\r\n      localStorage.setItem('currency', JSON.stringify(currency));\r\n    }\r\n  }, [cartState, currency]);\r\n\r\n  useEffect(() => {\r\n    getCurrencyRate(currency.toString())\r\n      .then((res) => {\r\n        if (currency.toString() === 'RUB') {\r\n          setCurrencyRate(() => 1 / 3);\r\n        } else {\r\n          setCurrencyRate(+res);\r\n        }\r\n      })\r\n      .catch((err) => console.error(err));\r\n  }, [currency]);\r\n\r\n  return (\r\n    <indexContext.Provider\r\n      value={{\r\n        collectionsData: collections,\r\n        runwaysData: runways,\r\n        hasStocks,\r\n      }}\r\n    >\r\n      <currencyContext.Provider\r\n        value={{\r\n          currency,\r\n          currencyRate,\r\n          setCurrency,\r\n          USDRate,\r\n        }}\r\n      >\r\n        <cartContext.Provider\r\n          value={{\r\n            cart: cartState,\r\n            addItem: addItemToCart,\r\n            removeItem: removeItemFromCart,\r\n            clearCart: clearCart,\r\n          }}\r\n        >\r\n          <noscript\r\n            dangerouslySetInnerHTML={{\r\n              __html: `<iframe\r\n              src=\"https://www.googletagmanager.com/ns.html?id=GTM-5XP658M\"\r\n              height=\"0\"\r\n              width=\"0\"\r\n              style=\"display:none;visibility:hidden\"\r\n            ></iframe>`,\r\n            }}\r\n          ></noscript>\r\n          <Header />\r\n          <ModalWindowStart />\r\n          <NextNprogress\r\n            color=\"#000\"\r\n            startPosition={0.3}\r\n            stopDelayMs={200}\r\n            height={3}\r\n          ></NextNprogress>\r\n          <main>\r\n            <Component {...pageProps} />\r\n          </main>\r\n          <ArrowUp />\r\n          <Footer />\r\n        </cartContext.Provider>\r\n      </currencyContext.Provider>\r\n    </indexContext.Provider>\r\n  );\r\n};\r\n\r\nMyApp.getInitialProps = async (\r\n  appContext: AppContext\r\n): Promise<AppInitialProps & IAppProps> => {\r\n  const appProps = await App.getInitialProps(appContext);\r\n\r\n  const { locale, defaultLocale } = appContext.router;\r\n\r\n  const cockpitDataCollections = await getCockpitCollection(\r\n    'Collections',\r\n    'filter[inMenu]=true&sort[_o]=1'\r\n  );\r\n  const cockpitGoods = await getCockpitCollection('Goods');\r\n  const cockpitDataRunways = await getCockpitCollection(\r\n    'Runways',\r\n    'filter[inMenu]=true'\r\n  );\r\n\r\n  const stockGoods = cockpitGoods.entries.filter(\r\n    ({ stockPrice }: ICockpitGoodsRaw) => stockPrice\r\n  );\r\n\r\n  const runways: ICockpitRunwaysAndLookbooksRaw[] = cockpitDataRunways.entries.map(\r\n    (el: ICockpitRunwaysAndLookbooksRaw) => {\r\n      return {\r\n        title: locale === defaultLocale ? el.title : el.title_en,\r\n        link: '/blind-style' + el.link,\r\n        inMenu: el.inMenu,\r\n      };\r\n    }\r\n  );\r\n\r\n  const collections = cockpitDataCollections.entries.map(\r\n    (el: ICockpitCollectionsRaw) => {\r\n      return {\r\n        title: locale === defaultLocale ? el.title : el.title_en,\r\n        link: `/collections${el.link}`,\r\n        inMenu: el.inMenu,\r\n        _id: el._id,\r\n      };\r\n    }\r\n  );\r\n\r\n  return {\r\n    ...appProps,\r\n    props: { collections, runways, hasStocks: !!stockGoods.length },\r\n  };\r\n};\r\n\r\nexport default MyApp;\r\n"]},"metadata":{},"sourceType":"module"}