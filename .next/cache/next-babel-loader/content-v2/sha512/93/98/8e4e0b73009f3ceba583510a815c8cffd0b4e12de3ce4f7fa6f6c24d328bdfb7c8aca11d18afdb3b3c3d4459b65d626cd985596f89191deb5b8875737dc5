{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\user\\\\Documents\\\\GitHub\\\\blind-blind\\\\pages\\\\_app.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useContext, useEffect, useState } from 'react';\nimport App from 'next/app';\nimport NextNprogress from 'nextjs-progressbar';\nimport Header from '../src/components/Header/Header';\nimport Footer from '../src/components/Footer/Footer';\nimport ModalWindowStart from '../src/components/ModalWindowStart/ModalWindowStart';\nimport ArrowUp from '../src/components/ArrowUp/ArrowUp';\nimport { cartContext } from '../src/context/cartContext';\nimport { indexContext } from '../src/context/cockpitContext';\nimport { currencyContext } from '../src/context/currencyContext';\nimport { getCockpitCollection } from '../src/utils/getCockpitData';\nimport { getCurrencyRate } from '../src/utils/getCurrencyRate';\nimport '../styles/main.scss';\nimport '../styles/intlTelInput.css';\n\nconst MyApp = ({\n  Component,\n  pageProps,\n  props: {\n    collections,\n    runways,\n    hasStocks\n  }\n}) => {\n  const curCartContext = useContext(cartContext);\n  const {\n    0: cartState,\n    1: setCartState\n  } = useState(curCartContext ? curCartContext.cart : []);\n  const {\n    0: USDRate,\n    1: changeUSDRate\n  } = useState(0);\n  const {\n    0: currency,\n    1: setCurrency\n  } = useState('UAH');\n  const {\n    0: currencyRate,\n    1: setCurrencyRate\n  } = useState(0);\n\n  const addItemToCart = item => {\n    if (!('receiverName' in item)) {\n      const existingItem = cartState.filter(el => el.id === item.id && !('receiverName' in el) && JSON.stringify(el.details) === JSON.stringify(item.details));\n\n      if (existingItem.length) {\n        const newItem = existingItem[0];\n        cartState.forEach(el => {\n          if (el.id === newItem.id && JSON.stringify(el.details) === JSON.stringify(newItem.details)) el.amount += 1;\n        });\n        setCartState([...cartState]);\n        return;\n      }\n    }\n\n    setCartState([...cartState, item]);\n  };\n\n  const removeItemFromCart = item => {\n    if (!('receiverName' in item)) setCartState([...cartState.filter(el => !(el.id === item.id && JSON.stringify(el.details) === JSON.stringify(item.details)))]);else setCartState([...cartState.filter(el => el.id !== item.id)]);\n  };\n\n  const clearCart = () => setCartState([]);\n\n  useEffect(() => {\n    if (false) {\n      const storageCart = localStorage.getItem('cart');\n\n      if (storageCart) {\n        setCartState(JSON.parse(storageCart));\n      }\n\n      const storageCurrency = localStorage.getItem('currency');\n\n      if (storageCurrency) {\n        setCurrency(JSON.parse(storageCurrency));\n      }\n    }\n  }, []);\n  useEffect(() => {\n    if (!USDRate) getCurrencyRate('USD').then(res => changeUSDRate(+res));\n  }, []);\n  useEffect(() => {\n    if (false) {\n      localStorage.setItem('cart', JSON.stringify(cartState));\n      localStorage.setItem('currency', JSON.stringify(currency));\n    }\n  }, [cartState, currency]);\n  useEffect(() => {\n    getCurrencyRate(currency.toString()).then(res => {\n      if (currency.toString() === 'RUB') {\n        setCurrencyRate(() => 1 / 3);\n      } else {\n        setCurrencyRate(+res);\n      }\n    }).catch(err => console.error(err));\n  }, [currency]);\n  return /*#__PURE__*/_jsxDEV(indexContext.Provider, {\n    value: {\n      collectionsData: collections,\n      runwaysData: runways,\n      hasStocks\n    },\n    children: /*#__PURE__*/_jsxDEV(currencyContext.Provider, {\n      value: {\n        currency,\n        currencyRate,\n        setCurrency,\n        USDRate\n      },\n      children: /*#__PURE__*/_jsxDEV(cartContext.Provider, {\n        value: {\n          cart: cartState,\n          addItem: addItemToCart,\n          removeItem: removeItemFromCart,\n          clearCart: clearCart\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"noscript\", {\n          dangerouslySetInnerHTML: {\n            __html: `<iframe\n              src=\"https://www.googletagmanager.com/ns.html?id=GTM-5XP658M\"\n              height=\"0\"\n              width=\"0\"\n              style=\"display:none;visibility:hidden\"\n            ></iframe>`\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ModalWindowStart, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(NextNprogress, {\n          color: \"#000\",\n          startPosition: 0.3,\n          stopDelayMs: 200,\n          height: 3\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n          children: /*#__PURE__*/_jsxDEV(Component, _objectSpread({}, pageProps), void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ArrowUp, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 5\n  }, this);\n};\n\nMyApp.getInitialProps = async (appContext) => {\n  const appProps = await App.getInitialProps(appContext);\n  const {\n    locale,\n    defaultLocale\n  } = appContext.router;\n  const cockpitDataCollections = await getCockpitCollection('Collections', 'filter[inMenu]=true&sort[_o]=1');\n  const cockpitGoods = await getCockpitCollection('Goods');\n  const cockpitDataRunways = await getCockpitCollection('Runways', 'filter[inMenu]=true');\n  const stockGoods = cockpitGoods.entries.filter(({\n    stockPrice\n  }) => stockPrice);\n  const runways = cockpitDataRunways.entries.map(el => {\n    return {\n      title: locale === defaultLocale ? el.title : el.title_en,\n      link: '/blind-style' + el.link,\n      inMenu: el.inMenu\n    };\n  });\n  const collections = cockpitDataCollections.entries.map(el => {\n    return {\n      title: locale === defaultLocale ? el.title : el.title_en,\n      link: `/collections${el.link}`,\n      inMenu: el.inMenu,\n      _id: el._id\n    };\n  });\n  return _objectSpread(_objectSpread({}, appProps), {}, {\n    props: {\n      collections,\n      runways,\n      hasStocks: !!stockGoods.length\n    }\n  });\n};\n\nexport default MyApp;","map":{"version":3,"sources":["C:/Users/user/Documents/GitHub/blind-blind/pages/_app.tsx"],"names":["useContext","useEffect","useState","App","NextNprogress","Header","Footer","ModalWindowStart","ArrowUp","cartContext","indexContext","currencyContext","getCockpitCollection","getCurrencyRate","MyApp","Component","pageProps","props","collections","runways","hasStocks","curCartContext","cartState","setCartState","cart","USDRate","changeUSDRate","currency","setCurrency","currencyRate","setCurrencyRate","addItemToCart","item","existingItem","filter","el","id","JSON","stringify","details","length","newItem","forEach","amount","removeItemFromCart","clearCart","storageCart","localStorage","getItem","parse","storageCurrency","then","res","setItem","toString","catch","err","console","error","collectionsData","runwaysData","addItem","removeItem","__html","getInitialProps","appContext","appProps","locale","defaultLocale","router","cockpitDataCollections","cockpitGoods","cockpitDataRunways","stockGoods","entries","stockPrice","map","title","title_en","link","inMenu","_id"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState } from 'react';\r\nimport App, { AppContext } from 'next/app';\r\nimport { AppProps } from 'next/dist/next-server/lib/router/router';\r\nimport { AppInitialProps } from 'next/dist/next-server/lib/utils';\r\nimport NextNprogress from 'nextjs-progressbar';\r\n\r\nimport {\r\n  ICartGoodsItemProps,\r\n  ICartVoucherItemProps,\r\n} from '../src/components/Cart/Types';\r\nimport Header from '../src/components/Header/Header';\r\nimport Footer from '../src/components/Footer/Footer';\r\nimport ModalWindowStart from '../src/components/ModalWindowStart/ModalWindowStart';\r\nimport ArrowUp from '../src/components/ArrowUp/ArrowUp';\r\n\r\nimport { cartContext } from '../src/context/cartContext';\r\nimport { indexContext } from '../src/context/cockpitContext';\r\nimport { currencyContext } from '../src/context/currencyContext';\r\nimport {\r\n  ICockpitCollectionsRaw,\r\n  ICockpitGoodsRaw,\r\n  ICockpitRunwaysAndLookbooksRaw,\r\n} from '../src/cockpitTypes';\r\nimport { IAppProps } from '../src/pagesTypes';\r\n\r\nimport { getCockpitCollection } from '../src/utils/getCockpitData';\r\nimport { getCurrencyRate } from '../src/utils/getCurrencyRate';\r\n\r\nimport '../styles/main.scss';\r\nimport { ECurrency } from '../src/context/Types';\r\n\r\nimport '../styles/intlTelInput.css';\r\n\r\nconst MyApp = ({\r\n  Component,\r\n  pageProps,\r\n  props: { collections, runways, hasStocks },\r\n}: AppProps & IAppProps): JSX.Element => {\r\n  const curCartContext = useContext(cartContext);\r\n\r\n  const [cartState, setCartState] = useState(\r\n    curCartContext ? curCartContext.cart : []\r\n  );\r\n\r\n  const [USDRate, changeUSDRate] = useState<number>(0);\r\n\r\n  const [currency, setCurrency] = useState<ECurrency>(\r\n    ('UAH' as unknown) as ECurrency\r\n  );\r\n  const [currencyRate, setCurrencyRate] = useState(0);\r\n\r\n  const addItemToCart = (item: ICartGoodsItemProps | ICartVoucherItemProps) => {\r\n    if (!('receiverName' in item)) {\r\n      const existingItem = cartState.filter(\r\n        (el) =>\r\n          el.id === item.id &&\r\n          !('receiverName' in el) &&\r\n          JSON.stringify(el.details) === JSON.stringify(item.details)\r\n      );\r\n\r\n      if (existingItem.length) {\r\n        const newItem = existingItem[0] as ICartGoodsItemProps;\r\n        cartState.forEach((el) => {\r\n          if (\r\n            el.id === newItem.id &&\r\n            JSON.stringify((el as ICartGoodsItemProps).details) ===\r\n              JSON.stringify(newItem.details)\r\n          )\r\n            el.amount += 1;\r\n        });\r\n        setCartState([...cartState]);\r\n        return;\r\n      }\r\n    }\r\n    setCartState([...cartState, item]);\r\n  };\r\n\r\n  const removeItemFromCart = (\r\n    item: ICartGoodsItemProps | ICartVoucherItemProps\r\n  ) => {\r\n    if (!('receiverName' in item))\r\n      setCartState([\r\n        ...cartState.filter(\r\n          (el) =>\r\n            !(\r\n              el.id === item.id &&\r\n              JSON.stringify((el as ICartGoodsItemProps).details) ===\r\n                JSON.stringify(item.details)\r\n            )\r\n        ),\r\n      ]);\r\n    else setCartState([...cartState.filter((el) => el.id !== item.id)]);\r\n  };\r\n\r\n  const clearCart = () => setCartState([]);\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const storageCart = localStorage.getItem('cart');\r\n      if (storageCart) {\r\n        setCartState(JSON.parse(storageCart));\r\n      }\r\n      const storageCurrency = localStorage.getItem('currency');\r\n      if (storageCurrency) {\r\n        setCurrency(JSON.parse(storageCurrency as keyof ECurrency));\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!USDRate) getCurrencyRate('USD').then((res) => changeUSDRate(+res));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.setItem('cart', JSON.stringify(cartState));\r\n      localStorage.setItem('currency', JSON.stringify(currency));\r\n    }\r\n  }, [cartState, currency]);\r\n\r\n  useEffect(() => {\r\n    getCurrencyRate(currency.toString())\r\n      .then((res) => {\r\n        if (currency.toString() === 'RUB') {\r\n          setCurrencyRate(() => 1 / 3);\r\n        } else {\r\n          setCurrencyRate(+res);\r\n        }\r\n      })\r\n      .catch((err) => console.error(err));\r\n  }, [currency]);\r\n\r\n  return (\r\n    <indexContext.Provider\r\n      value={{\r\n        collectionsData: collections,\r\n        runwaysData: runways,\r\n        hasStocks,\r\n      }}\r\n    >\r\n      <currencyContext.Provider\r\n        value={{\r\n          currency,\r\n          currencyRate,\r\n          setCurrency,\r\n          USDRate,\r\n        }}\r\n      >\r\n        <cartContext.Provider\r\n          value={{\r\n            cart: cartState,\r\n            addItem: addItemToCart,\r\n            removeItem: removeItemFromCart,\r\n            clearCart: clearCart,\r\n          }}\r\n        >\r\n          <noscript\r\n            dangerouslySetInnerHTML={{\r\n              __html: `<iframe\r\n              src=\"https://www.googletagmanager.com/ns.html?id=GTM-5XP658M\"\r\n              height=\"0\"\r\n              width=\"0\"\r\n              style=\"display:none;visibility:hidden\"\r\n            ></iframe>`,\r\n            }}\r\n          ></noscript>\r\n          <Header />\r\n          <ModalWindowStart />\r\n          <NextNprogress\r\n            color=\"#000\"\r\n            startPosition={0.3}\r\n            stopDelayMs={200}\r\n            height={3}\r\n          ></NextNprogress>\r\n          <main>\r\n            <Component {...pageProps} />\r\n          </main>\r\n          <ArrowUp />\r\n          <Footer />\r\n        </cartContext.Provider>\r\n      </currencyContext.Provider>\r\n    </indexContext.Provider>\r\n  );\r\n};\r\n\r\nMyApp.getInitialProps = async (\r\n  appContext: AppContext\r\n): Promise<AppInitialProps & IAppProps> => {\r\n  const appProps = await App.getInitialProps(appContext);\r\n\r\n  const { locale, defaultLocale } = appContext.router;\r\n\r\n  const cockpitDataCollections = await getCockpitCollection(\r\n    'Collections',\r\n    'filter[inMenu]=true&sort[_o]=1'\r\n  );\r\n  const cockpitGoods = await getCockpitCollection('Goods');\r\n  const cockpitDataRunways = await getCockpitCollection(\r\n    'Runways',\r\n    'filter[inMenu]=true'\r\n  );\r\n\r\n  const stockGoods = cockpitGoods.entries.filter(\r\n    ({ stockPrice }: ICockpitGoodsRaw) => stockPrice\r\n  );\r\n\r\n  const runways: ICockpitRunwaysAndLookbooksRaw[] = cockpitDataRunways.entries.map(\r\n    (el: ICockpitRunwaysAndLookbooksRaw) => {\r\n      return {\r\n        title: locale === defaultLocale ? el.title : el.title_en,\r\n        link: '/blind-style' + el.link,\r\n        inMenu: el.inMenu,\r\n      };\r\n    }\r\n  );\r\n\r\n  const collections = cockpitDataCollections.entries.map(\r\n    (el: ICockpitCollectionsRaw) => {\r\n      return {\r\n        title: locale === defaultLocale ? el.title : el.title_en,\r\n        link: `/collections${el.link}`,\r\n        inMenu: el.inMenu,\r\n        _id: el._id,\r\n      };\r\n    }\r\n  );\r\n\r\n  return {\r\n    ...appProps,\r\n    props: { collections, runways, hasStocks: !!stockGoods.length },\r\n  };\r\n};\r\n\r\nexport default MyApp;\r\n"]},"metadata":{},"sourceType":"module"}